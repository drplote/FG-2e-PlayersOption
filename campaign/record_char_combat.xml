<?xml version="1.0" encoding="iso-8859-1"?>

<!-- 
  Please see the license.html file included with this distribution for 
  attribution and copyright information.
-->

<root>
  <windowclass name="combat_mini_section" merge="join">
    <sheetdata>

      <buttoncontrol name="delayturnbutton" insertafter="turnlevel">
        <anchored height="25" width="20" >
           <top offset="15" />
           <left parent="surprise_total_roll" anchor="right" relation="relative" offset="30" />
        </anchored>
        <icon normal="delayTurnButtonIcon" pressed="delayTurnButtonIcon" />
        <script>         
          function onButtonPress()
            CombatManagerPO.notifyDelayTurn();
          end

          function onInit()
            OptionsManager.registerCallback(PlayerOptionManager.sPhasedInitiativeOptionKey, onInitOptionChanged);
            onInitOptionChanged();
          end

          function onInitOptionChanged()
            local bVisible = PlayerOptionManager.isUsingPhasedInitiative()
            setVisible(bVisible);
            window.label_delayturnbutton.setVisible(bVisible);
          end
        </script>
        <frame name="fielddark" offset="7,5,7,5" />
        <stateframe>
          <hover name="rowshade" offset="7,5,7,5" />
        </stateframe>
        <tooltip textres="char_label_end_turn_tooltip" />
      </buttoncontrol>

      <label_fieldtop name="label_delayturnbutton" insertafter="delayturnbutton">
        <anchored to="delayturnbutton" />
        <font>regular10</font>
        <center />
        <static textres="char_label_delay_turn" />
        <tooltip textres="char_label_delay_turn_tooltip" />
      </label_fieldtop>

      <buttoncontrol name="endturnbutton" insertafter="label_delayturnbutton">
        <anchored height="25" width="20" >
           <top offset="15" />
           <left parent="surprise_total_roll" anchor="right" relation="relative" offset="15" />
        </anchored>
        <icon normal="endTurnButtonIcon" pressed="endTurnButtonIcon" />
        <script>         
          function onButtonPress()
            CombatManager.notifyEndTurn();
          end
        </script>
        <frame name="fielddark" offset="7,5,7,5" />
        <stateframe>
          <hover name="rowshade" offset="7,5,7,5" />
        </stateframe>
        <tooltip textres="char_label_end_turn_tooltip" />
      </buttoncontrol>

      <label_fieldtop name="label_endturnbutton" insertafter="endturnbutton">
        <anchored to="endturnbutton" />
        <font>regular10</font>
        <center />
        <static textres="char_label_end_turn" />
        <tooltip textres="char_label_end_turn_tooltip" />
      </label_fieldtop>

    </sheetdata>
  </windowclass>  
</root>
