<?xml version="1.0" encoding="iso-8859-1"?>

<root>
	<windowclass name="combat_mini_section" merge="join" insertbefore="combat_thaco_matrix">
		<sheetdata>

			<button_surprise name="surprise_total_roll" source="surprise.total" merge="replace">
		        <anchored height="25" width="20" >
  		        	<top offset="15" />
			    	<left anchor="center" offset="-80"/>
        		</anchored>
			</button_surprise>

			<buttoncontrol name="requestTurnButton">
				<anchored height="25" width="20" >
					<top offset="15" />
					<left parent="surprise_total_roll" anchor="right" relation="relative" offset="15" />
				</anchored>
				<icon normal="requestTurnIcon" />
				<script>         
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  CombatManagerPO.notifyRequestTurn(nodeChar);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
					<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_label_request_turn_tooltip" />
			</buttoncontrol>


			<buttoncontrol name="endturnbutton">
				<anchored height="25" width="20" >
					<top offset="15" />
					<left parent="surprise_total_roll" anchor="right" relation="relative" offset="15" />
				</anchored>
				<icon normal="endTurnButtonIcon" />
				<script>         
					function action(draginfo)
		   			  local nodeChar = window.getDatabaseNode();
					  local nodeCT = CombatManager.getCTFromNode(nodeChar);
					  local nodeCTActive = CombatManager.getActiveCT();
					  if nodeCT == nodeCTActive then
						CombatManager.notifyEndTurn();
					  else
						ChatManagerPO.deliverEndTurnFailedMessage(nodeChar);
					  end
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
					<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_label_end_turn_tooltip" />
			</buttoncontrol>

			<label_fieldtop name="label_endturnbutton">
				<anchored to="endturnbutton" />
				<font>regular10</font>
				<center />
				<static textres="char_label_end_turn" />
				<tooltip textres="char_label_end_turn_tooltip" />
			</label_fieldtop>

			<label_fieldtop name="label_requestTurnButton">
				<anchored to="requestTurnButton" />
				<font>regular10</font>
				<center />
				<static textres="char_label_request_turn" />
				<tooltip textres="char_label_request_turn_tooltip" />
			</label_fieldtop>

			<label name="segment_delay_label">
				<font>bold11</font>
				<anchored >
					<top offset="45" />
					<left anchor="center" offset="-35" />
				</anchored>
				<static textres="segment_delay_label" />
			</label>

			<buttoncontrol name="delay1Button">
				<icon normal="delayTurn1ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left anchor="center" offset="-150"/>
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 1);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay1_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay2Button">
				<icon normal="delayTurn2ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay1Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 2);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay2_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay3Button">
				<icon normal="delayTurn3ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay2Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 3);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay3_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay4Button">
				<icon normal="delayTurn4ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay3Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 4);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay4_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay5Button">
				<icon normal="delayTurn5ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay4Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 5);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay5_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay6Button">
				<icon normal="delayTurn6ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay5Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 6);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay6_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay7Button">
				<icon normal="delayTurn7ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay6Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 7);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay7_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay8Button">
				<icon normal="delayTurn8ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay7Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 8);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay8_tooltip" />
			</buttoncontrol>
			<buttoncontrol name="delay9Button">
				<icon normal="delayTurn9ButtonIcon" />
					<anchored height="25" width="20" >
					<top offset="65" />
					<left parent="delay8Button" anchor="right" relation="relative" offset="15" />
				</anchored>
				<script>
					function action(draginfo)
					  local nodeChar = window.getDatabaseNode();
					  InitManagerPO.tryDelayActor(nodeChar, 9);
					  return true;
					end

					function onDragStart(button, x, y, draginfo)
					  return action(draginfo);
					end

					function onDoubleClick(x,y)
					  return action();
					end
				</script>
				<frame name="fielddark" offset="7,5,7,5" />
				<stateframe>
				<hover name="rowshade" offset="7,5,7,5" />
				</stateframe>
				<tooltip textres="char_initdelay9_tooltip" />
			</buttoncontrol>

			<subwindow name="combat_thaco_matrix">
				<anchored>
				  <top offset="95" />
				  <left anchor="center" offset="-180" />
				  <right offset="-5" />
				</anchored>
			</subwindow> 
		</sheetdata>
	</windowclass>
</root>